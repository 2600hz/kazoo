#+OPTIONS: ':nil *:t -:t ::t <:t H:2 \n:nil ^:t arch:headline
#+OPTIONS: author:t c:nil creator:nil d:(not "LOGBOOK") date:nil e:t
#+OPTIONS: email:nil f:t inline:t num:t p:nil pri:nil prop:nil stat:t
#+OPTIONS: tags:t tasks:t tex:t timestamp:f title:nil toc:nil todo:t |:t
#+TITLE: Pivot - Real-Time Call Control
#+DATE: \today
#+AUTHOR: James Aimonetti
#+EMAIL: james@2600hz.com
#+LANGUAGE: en
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport
#+CREATOR: Emacs 25.1.50.3 (Org mode 8.3.4)
#+STARTUP: beamer
#+LaTeX_CLASS: beamer
#+LaTeX_CLASS_OPTIONS: [article,12pt]
#+BEAMER_FRAME_LEVEL: 2
#+LATEX_HEADER: \usebackgroundtemplate%
#+LATEX_HEADER:{%
#+LATEX_HEADER:    \includegraphics[width=\paperwidth,height=\paperheight]{./images/default_slide.png}%
#+LATEX_HEADER:}

* Pivot
#+BEGIN_LaTeX
{
\usebackgroundtemplate{\includegraphics[width=\paperwidth,height=\paperheight]{./images/first_slide.png}}%
\begin{frame}
\begin{center}
\alert{PIVOT - REAL-TIME CALL CONTROL}
\end{center}
\end{frame}
}
#+END_LaTeX

** About Myself
*** About Myself                                           :B_column:BMCOL:
    :PROPERTIES:
    :BEAMER_col: 0.45
    :BEAMER_env: column
    :END:
 - James Aimonetti
 - Kazoo Architect and Community at 2600Hz
 - mc_ on freenode
*** Presenter                                                       :BMCOL:
    :PROPERTIES:
    :BEAMER_col: 0.45
    :END:
#+BEGIN_CENTER
[[./images/presenter_h280.jpg]]
#+END_CENTER
** High-level                                                       :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
- Point a callflow at your server
- Process the call against your business logic
- Return Kazoo callflow JSON
** Flow                                                             :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
[[./images/pivot_flow.png]]
** Setting up Kazoo                                                 :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
- create a callflow
- set the pivot action as the child
- set the URL to your webserver and script

Pivot will attempt to reach your server for calls to that callflow.
** The Request                                                      :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
- GET - query string parameters
- POST - x-www-form-urlencoded request body
** Common Request Fields                                            :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
| Name             | Description       |
|------------------+-------------------|
| Call-ID          | SIP Call-ID field |
| Request          | SIP Request user  |
| To               | SIP To user       |
| From             | SIP From user     |
| Account-ID       | Kazoo Account ID  |
| Caller-ID-Name   | CID Name          |
| Caller-ID-Number | CID Number        |                   |                   |
** Other Request Fields                                             :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
| Name     | Description                                 |
|----------+---------------------------------------------|
| Digits   | DTMFs (or collections) received             |
| User-ID  | Owner ID(s) of the calling device           |
| Language | Configured language for device/user/account |

** Create a handler                                                 :B_block:
:PROPERTIES:
:BEAMER_env: block
:END:
- Create the script that Pivot will make a request to
- Process and build the Kazoo callflow JSON
- Set "Content-Type" header to "application/json"
- Return the JSON as the body of the HTTP response
** Let's Build something!
#+BEGIN_CENTER
Demo Time!
#+END_CENTER
** Build all the things                                            :B_frame:
:PROPERTIES:
:BEAMER_env: frame
:END:
*** Say something
#+BEGIN_SRC php
<?php header("content-type:application/json"); ?>
{"module":"tts"
 ,"data":{"text":"Hello caller"}
}
#+END_SRC
* Thank You
#+BEGIN_LaTeX
{
\usebackgroundtemplate{\includegraphics[width=\paperwidth,height=\paperheight]{./images/last_slide.png}}%
\begin{frame}
\begin{center}
\alert{THANK YOU}
\end{center}
\end{frame}
}
#+END_LaTeX
