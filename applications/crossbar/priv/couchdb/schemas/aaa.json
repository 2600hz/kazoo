{
    "$schema": "http://json-schema.org/draft-03/schema#",
    "_id": "aaa",
    "description": "Schema for an AAA configuration",
    "name": "AAA configuration",
    "properties": {
        "aaa_mode": {
            "default": "off",
            "description": "AAA mode for this account uses to enable/disable AAA features",
            "enum": [
                "off",
                "on",
                "inherit"
            ],
            "name": "AAA mode",
            "required": false,
            "type": "string"
        },
        "servers": {
            "description": "List of the available AAA servers",
            "items": {
                "description": "AAA server entry",
                "properties": {
                    "aaa_engine": {
                        "default": "radius",
                        "description": "Engine (protocol) which is used by AAA features",
                        "enum": [
                            "radius",
                            "diameter"
                        ],
                        "name": "AAA engine",
                        "required": false,
                        "type": "string"
                    },
                    "address": {
                        "description": "AAA server address (fully qualified domain name or IP)",
                        "minLength": 3,
                        "name": "Server address",
                        "required": true,
                        "type": "string"
                    },
                    "avp": {
                        "default": "strict",
                        "description": "AVP strict checking using available dictionaries or any user's AVPs can be acceptable",
                        "enum": [
                            "strict",
                            "custom"
                        ],
                        "name": "AVP checking",
                        "required": false,
                        "type": "string"
                    },
                    "dicts": {
                        "description": "List of all dictionaries from aaa_dicts database (all names should be unique)",
                        "items": {
                            "type": "string"
                        },
                        "name": "Dictionary name list",
                        "type": "array"
                    },
                    "enabled": {
                        "default": false,
                        "description": "Is the server used in AAA operations",
                        "type": "boolean"
                    },
                    "name": {
                        "description": "AAA server name which should be unique",
                        "minLength": 1,
                        "name": "Server name",
                        "required": true,
                        "type": "string"
                    },
                    "nas_address": {
                        "default": 5000,
                        "description": "Network Access Server address",
                        "name": "NAS Address",
                        "required": true,
                        "type": "string"
                    },
                    "nas_port": {
                        "default": 5000,
                        "description": "Network Access Server port",
                        "name": "NAS Port",
                        "required": true,
                        "type": "integer"
                    },
                    "port": {
                        "default": 1812,
                        "description": "AAA server port",
                        "name": "Server port",
                        "required": true,
                        "type": "integer"
                    },
                    "retries": {
                        "default": 5,
                        "description": "Number of a request retries to the AAA server",
                        "name": "Number of retries",
                        "required": true,
                        "type": "integer"
                    },
                    "secret": {
                        "description": "Secret string which the AAA server knows",
                        "minLength": 1,
                        "name": "Server secret",
                        "required": true,
                        "type": "string"
                    },
                    "timeout": {
                        "default": 5000,
                        "description": "Request timeout to the AAA server in milliseconds",
                        "name": "Request timeout",
                        "required": true,
                        "type": "integer"
                    }
                },
                "type": "object"
            },
            "name": "AAA servers list",
            "required": true,
            "type": "array"
        }
    },
    "required": true,
    "type": "object"
}
